<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>تحلیلگر پیشرفته ارز</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <div class="container">
        <h1 class="header">🚀 تحلیلگر پیشرفته ارز و بازار مالی</h1>

        <div class="api-section">
            <h3>🔑 تنظیمات API</h3>
            <input type="password" id="openai-api-key" class="api-input" placeholder="کلید API ChatGPT را وارد کنید">
            <button class="btn" id="save-key-btn">💾 ذخیره کلید</button>
            <button class="btn" id="test-conn-btn">🔗 تست اتصال</button>
        </div>

        <div class="tabs" role="tablist">
            <div class="tab active" data-tab="analysis">📊 تحلیل لحظه‌ای</div>
            <div class="tab" data-tab="history">📈 تاریخچه قیمت‌ها</div>
            <div class="tab" data-tab="patterns">🎯 الگوهای معاملاتی</div>
            <div class="tab" data-tab="recommendations">💡 پیشنهادات</div>
        </div>

        <div id="analysis-tab" class="tab-content active">
            <div class="actions-row">
                <button class="btn" id="start-analysis-btn">🔍 شروع تحلیل</button>
                <button class="btn" id="refresh-data-btn">🔄 بروزرسانی</button>
            </div>

            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>در حال تحلیل بازار...</p>
            </div>

            <div class="analysis-grid" id="analysis-results"></div>

            <div class="deep-box">
                <div class="deep-box-header">
                    <h3>🧠 تحلیل عمیق (بازه ۱۰ دقیقه آینده)</h3>
                    <button class="btn secondary" id="run-deep-analysis-btn">🚦 اجرای تحلیل عمیق</button>
                </div>
                <div id="deep-analysis-output" class="deep-output">برای اجرای تحلیل عمیق، ابتدا داده‌ها را دریافت کنید و سپس دکمه بالا را فشار دهید.</div>
            </div>
        </div>

        <div id="history-tab" class="tab-content">
            <div class="date-selector">
                <label>📅 انتخاب تاریخ:</label>
                <input type="date" id="history-date" class="api-input">
                <label>⏰ انتخاب ساعت:</label>
                <input type="time" id="history-time" class="api-input">
                <button class="btn" id="show-history-btn">📊 نمایش قیمت‌ها</button>
            </div>

            <div class="chart-container">
                <canvas id="price-chart"></canvas>
            </div>

            <div id="historical-analysis"></div>
        </div>

        <div id="patterns-tab" class="tab-content">
            <div class="actions-row">
                <button class="btn" id="analyze-patterns-btn">🔍 تحلیل الگوها</button>
                <button class="btn" id="generate-formula-btn">📐 ایجاد فرمول</button>
            </div>

            <div class="pattern-card" id="pattern-results">
                <h3>🎯 الگوهای معاملاتی شناسایی شده</h3>
                <p>برای تحلیل الگوها، ابتدا دکمه "تحلیل الگوها" را فشار دهید.</p>
            </div>
        </div>

        <div id="recommendations-tab" class="tab-content">
            <button class="btn" id="generate-recs-btn">💡 تولید پیشنهادات</button>

            <div class="recommendation-box" id="buy-recommendations">
                <h3>🟢 پیشنهادات خرید</h3>
                <p>در انتظار تحلیل...</p>
            </div>

            <div class="recommendation-box" id="sell-recommendations">
                <h3>🔴 پیشنهادات فروش</h3>
                <p>در انتظار تحلیل...</p>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>